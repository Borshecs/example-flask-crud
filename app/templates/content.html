{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row">
        <!-- Character Form -->
        <div class="col-md-6">
            <div class="card">
                <h2 class="ml-5 mt-5">Create Character</h2>
                <div class="card-body">
                    <form id="characterForm">
                        <div class="form-group">
                            <input class="form-control" type="text" id="name" placeholder="Character Name" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="number" id="age" placeholder="Age" required>
                        </div>
                        <div class="form-group">
                            <textarea class="form-control" id="description" rows="3" placeholder="Description"></textarea>
                        </div>
                        <div class="form-group">
                            <select class="form-control" id="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="text" id="race" placeholder="Race" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="text" id="char_class" placeholder="Character Class" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="number" id="creator_id" placeholder="Creator ID" required>
                        </div>
                        <button class="btn btn-primary" type="submit">Create Character</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Character List -->
        <div class="col-md-6">
            <table class="table table-bordered table-hover">
                <h2 class="text-center">Character List</h2>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Age</th>
                        <th>Gender</th>
                        <th>Race</th>
                        <th>Class</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="characterList">
                    {% for character in characters %}
                    <tr>
                        <td>{{ character.id }}</td>
                        <td>{{ character.name }}</td>
                        <td>{{ character.age }}</td>
                        <td>{{ character.gender }}</td>
                        <td>{{ character.race }}</td>
                        <td>{{ character.char_class }}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteCharacter({{ character.id }})">Delete</button>
                            <a href="/edit/{{ character.id }}" class="btn btn-sm btn-primary">Edit</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Spell Form -->
        <div class="col-md-6">
            <div class="card mt-5">
                <h2 class="ml-5 mt-5">Add Spell</h2>
                <div class="card-body">
                    <form id="spellForm">
                        <div class="form-group">
                            <textarea class="form-control" id="spellDescription" rows="3" placeholder="Description"></textarea>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="text" id="spellImpact" placeholder="Impact" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="text" id="spellDifficultyLevel" placeholder="Difficulty Level" required>
                        </div>
                        <button class="btn btn-primary" type="submit">Create Spell</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Spell List -->
        <div class="col-md-6">
            <h2 class="text-center">Spells List</h2>
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Description</th>
                        <th>Impact</th>
                        <th>Difficulty Level</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="spellList">
                    {% for spell in spells %}
                    <tr>
                        <td>{{ spell.id }}</td>
                        <td>{{ spell.description }}</td>
                        <td>{{ spell.impact }}</td>
                        <td>{{ spell.difficulty_level }}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteSpell({{ spell.id }})">Delete</button>
                           
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="col-md-6">
            <div class="card mt-5">
                <h2 class="ml-5 mt-5">Add Weapon</h2>
                <div class="card-body">
                    <form id="weaponForm">
                        <div class="form-group">
                            <input class="form-control" type="text" id="weaponType" placeholder="Weapon Type" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="number" id="weaponSkillRate" placeholder="Skill Rate" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control" type="number" id="weaponPlayersRate" placeholder="Players Rate" required>
                        </div>
                        <div class="form-group">
                            <input type="checkbox" id="weaponQuest" checked> Quest
                        </div>
                        <button class="btn btn-primary" type="submit">Create Weapon</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Weapon List -->
        <div class="col-md-6">
            <h2 class="text-center">Weapons List</h2>
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Type</th>
                        <th>Skill Rate</th>
                        <th>Players Rate</th>
                        <th>Quest</th>
                    </tr>
                </thead>
                <tbody id="weaponList">
                    {% for weapon in weapons %}
                    <tr>
                        <td>{{ weapon.id }}</td>
                        <td>{{ weapon.type }}</td>
                        <td>{{ weapon.skill_rate }}</td>
                        <td>{{ weapon.players_rate }}</td>
                        <td>{{ weapon.quest }}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteWeapon({{ weapon.id }})">Delete</button>
                            
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Characteristic Form -->
        <div class="col-md-6">
            <div class="card mt-5">
                <h2 class="ml-5 mt-5">Add Characteristic</h2>
                <div class="card-body">
                    <form id="characteristicForm">
                        <div class="form-group">
                            <input class="form-control" type="text" id="characteristicName" placeholder="Characteristic Name" required>
                        </div>
                        <button class="btn btn-primary" type="submit">Create Characteristic</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Characteristic List -->
        <div class="col-md-6">
            <h2 class="text-center">Characteristics List</h2>
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="characteristicList">
                    {% for characteristic in characteristics %}
                    <tr>
                        <td>{{ characteristic.id }}</td>
                        <td>{{ characteristic.name }}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteCharacteristic({{ characteristic.id }})">Delete</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Skill Form -->
        <div class="col-md-6">
            <div class="card mt-5">
                <h2 class="ml-5 mt-5">Add Skill</h2>
                <div class="card-body">
                    <form id="skillForm">
                        <div class="form-group">
                            <input class="form-control" type="text" id="skillName" placeholder="Skill Name" required>
                        </div>
                        <button class="btn btn-primary" type="submit">Create Skill</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Skill List -->
        <div class="col-md-6">
            <h2 class="text-center">Skills List</h2>
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="skillList">
                    {% for skill in skills %}
                    <tr>
                        <td>{{ skill.id }}</td>
                        <td>{{ skill.name }}</td>
                        <td>
                            <button class="btn btn-sm btn-danger" onclick="deleteSkill({{ skill.id }})">Delete</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>


<script>
    document.getElementById('weaponForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Collect form data
        var formData = {
            type: document.getElementById('weaponType').value,
            skill_rate: document.getElementById('weaponSkillRate').value,
            players_rate: document.getElementById('weaponPlayersRate').value,
            quest: document.getElementById('weaponQuest').checked
        };

        // Send form data as JSON to the server
        fetch('/weapons', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(function(response) {
            // Handle the response
            if (response.ok) {
                alert('Weapon created successfully');
                window.location.reload(); // Reload the page after successful submission
            } else {
                alert('Failed to create weapon');
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });
    
    // Function to delete a character
    function deleteCharacteristic(id) {
        fetch(`/characteristics/${id}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                alert('Characteristic deleted successfully');
                window.location.reload(); // Reload the page after successful deletion
            } else {
                alert('Failed to delete characteristic');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    }
    // Event listener for skill form submission
    document.getElementById('skillForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Collect form data
        var formData = {
            name: document.getElementById('skillName').value
        };

        // Send form data as JSON to the server
        fetch('/skills', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(function(response) {
            // Handle the response
            if (response.ok) {
                alert('Skill created successfully');
                window.location.reload(); // Reload the page after successful submission
            } else {
                alert('Failed to create skill');
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });

    // Function to delete a skill
    function deleteSkill(id) {
        fetch(`/skills/${id}`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                alert('Skill deleted successfully');
                window.location.reload(); // Reload the page after successful deletion
            } else {
                alert('Failed to delete skill');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    }
    function deleteCharacter(id) {
        if (confirm('Are you sure you want to delete this character?')) {
            fetch(`/characters/${id}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    alert('Character deleted successfully');
                    window.location.reload(); // Reload the page after successful deletion
                } else {
                    alert('Failed to delete character');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
            });
        }
    }

    // Function to delete a spell
    function deleteSpell(id) {
        if (confirm('Are you sure you want to delete this spell?')) {
            fetch(`/spell/${id}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    alert('Spell deleted successfully');
                    window.location.reload(); // Reload the page after successful deletion
                } else {
                    alert('Failed to delete spell');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
            });
        }
    }
    function deleteWeapon(id) {
        if (confirm('Are you sure you want to delete this wepaons?')) {
            fetch(`/weapons/${id}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    alert('wepaons deleted successfully');
                    window.location.reload(); // Reload the page after successful deletion
                } else {
                    alert('Failed to delete wepaons');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
            });
        }
    }

        document.getElementById('characteristicForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Collect form data
        var formData = {
            name: document.getElementById('characteristicName').value
        };

        // Send form data as JSON to the server
        fetch('/characteristics', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(function(response) {
            // Handle the response
            if (response.ok) {
                alert('Characteristic created successfully');
                window.location.reload(); // Reload the page after successful submission
            } else {
                alert('Failed to create characteristic');
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });

    // Event listener for character form submission
    document.getElementById('characterForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Collect form data
        var formData = {
            name: document.getElementById('name').value,
            age: document.getElementById('age').value,
            description: document.getElementById('description').value,
            gender: document.getElementById('gender').value,
            race: document.getElementById('race').value,
            char_class: document.getElementById('char_class').value,
            creator_id: document.getElementById('creator_id').value
        };

        // Send form data as JSON to the server
        fetch('/characters', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(function(response) {
            // Handle the response
            if (response.ok) {
                alert('Character created successfully');
                window.location.reload(); // Reload the page after successful submission
            } else {
                alert('Failed to create character');
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });

    // Event listener for spell form submission
    document.getElementById('spellForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent the default form submission

        // Collect form data
        var formData = {
            description: document.getElementById('spellDescription').value,
            impact: document.getElementById('spellImpact').value,
            difficulty_level: document.getElementById('spellDifficultyLevel').value
        };

        // Send form data as JSON to the server
        fetch('/spellsAdd', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(function(response) {
            // Handle the response
            if (response.ok) {
                alert('Spell created successfully');
                window.location.reload(); // Reload the page after successful submission
            } else {
                alert('Failed to create spell');
            }
        })
        .catch(function(error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again later.');
        });
    });
</script>

{% endblock %}
